# 线程池相关

## 线程池的实现原理

[深入分析java线程池的实现原理](https://www.jianshu.com/p/87bff5cc8d8c)

## 线程池的好处？ 四种线程池的使用场景，线程池的几个参数的理解？

使用线程池的好处是减少在创建和销毁线程上所花的时间以及系统资源的开销，解决资源不足的问题。如果不使用线程池，有可能造成系统创建大量同类线程而导致消耗完内存或则“过度切换”的问题，归纳总结就是

* 重用存在的线程，减少对象创建、消亡的开销，性能佳。
* 可有效控制最大并发线程数，提高系统资源的使用率，同时避免过多资源竞争，避免堵塞。
* 提供定时执行、定期执行、单线程、并发数控制等功能。

Android中的线程池都是直接或间接通过配置ThreadPoolExecutor来实现不同特性的线程池.Android中最常见的类具有不同特性的线程池分别为：

* **newCachedThreadPool**：只有非核心线程，最大线程数非常大，所有线程都活动时会为新任务创建新线程,否则会利用空闲线程（60s空闲时间,过了就会被回收,所以线程池中有0个线程的可能）来处理任务。
  * 优点：任何任务都会被立即执行(任务队列SynchronousQuue相当于一个空集合);比较适合执行大量的耗时较少的任务。
* **newFixedThreadPool**：只有核心线程，并且数量固定的，所有线程都活动时，因为队列没有限制大小，新任务会等待执行，当线程池空闲时不会释放工作线程，还会占用一定的系统资源。
  * 优点：更快的响应外界请求。
* **newScheduledThreadPool**：核心线程数固定,非核心线程（闲着没活干会被立即回收数）没有限制。
  * 优点：执行定时任务以及有固定周期的重复任务。
* **newSingleThreadExecutor**：只有一个核心线程,确保所有的任务都在同一线程中按序完成。
  * 优点：不需要处理线程同步的问题

[java线程池解析和四种线程池的使用](https://blog.csdn.net/ztchun/article/details/57413255)

## ThreadPoolExecutor的工作策略

* 如果线程池中的线程数量未达到核心线程的数量，那么会直接启动一个核心线程来执行任务。
* 如果线程池中的线程数量已经达到或则超过核心线程的数量，那么任务会被插入任务队列中排队等待执行。
* 如果在第2点无法将任务插入到任务队列中，这往往是由于任务队列已满，这个时候如果在线程数量未达到线程池规定的最大值，那么会立刻启动一个非核心线程来执行任务。
* 如果第3点中线程数量已经达到线程池规定的最大值，那么就拒绝执行此任务，ThreadPoolExecutor会调用RejectedExecutionHandler的rejectedExecution方法来通知调用者。