# 内存优化

[浅谈Android内存优化](https://juejin.im/post/5c978bc4e51d45101a372077)

* 节制地使用Service
* 当界面不可见时释放内存
* 当内存紧张时释放内存（onTrimMemory）
* 避免在Bitmap上浪费内存
* 使用优化过的数据集合
* 知晓内存的开支情况
* 谨慎使用抽象编程
* 尽量避免使用依赖注入框架
* 使用ProGuard简化代码

## 内存泄漏

* 集合类泄漏

    集合类添加元素后，仍引用着集合元素对象，导致该集合中的元素对象无法被回收，从而导致内存泄露。

* 单例/静态变量造成的内存泄漏

    单例模式具有其 静态特性，它的生命周期 等于应用程序的生命周期，正是因为这一点，往往很容易造成内存泄漏。

* 匿名内部类/非静态内部类

    非静态内部类他会持有他外部类的引用，如果非静态内部类的周明周期长于外部类，在加上自动持有外部类的强引用，造成内存泄漏。

* 资源未关闭造成的内存泄漏

    * 网络、文件等流忘记关闭
    * 手动注册广播时，退出时忘记 unregisterReceiver()
    * Service 执行完后忘记 stopSelf()
    * EventBus 等观察者模式的框架忘记手动解除注册

## 工具

* [leakcanary](https://github.com/square/leakcanary)
* as 3.0之后的profiler或者as 3.0之前的monitor
* Android Lint